(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5c7106ce"],{"0bd9":function(e,t,i){"use strict";var a=i("2092"),n=i.n(a);n.a},2092:function(e,t,i){},2423:function(e,t,i){"use strict";i.d(t,"d",function(){return n}),i.d(t,"c",function(){return l}),i.d(t,"a",function(){return o}),i.d(t,"f",function(){return r}),i.d(t,"e",function(){return s}),i.d(t,"b",function(){return u});var a=i("b775");function n(e){return Object(a["a"])({url:"/article/list",method:"get",params:e})}function l(e){return Object(a["a"])({url:"/article/detail",method:"get",params:{id:e}})}function o(e){return Object(a["a"])({url:"/article/create",method:"post",data:e})}function r(e){return Object(a["a"])({url:"/article/update",method:"post",data:e})}function s(e){return Object(a["a"])({url:"/article/".concat(e),method:"put"})}function u(e){return Object(a["a"])({url:"/article/".concat(e),method:"delete"})}},"34cd":function(e,t,i){"use strict";i.d(t,"b",function(){return n}),i.d(t,"a",function(){return l}),i.d(t,"d",function(){return o}),i.d(t,"c",function(){return r});var a=i("b775");function n(e){return Object(a["a"])({url:"/label/tree",method:"get",params:{needRoot:e}})}function l(e){return Object(a["a"])({url:"/label/add",method:"post",data:e})}function o(e,t){return Object(a["a"])({url:"/label/".concat(e),method:"put",data:t})}function r(e){return Object(a["a"])({url:"/label/".concat(e),method:"delete"})}},"49b7":function(e,t,i){"use strict";var a=i("dc44"),n=i.n(a);n.a},"94bb":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"createPost-container"},[i("el-form",{ref:"postForm",staticClass:"form-container",attrs:{model:e.postForm,rules:e.rules}},[i("sticky",{staticStyle:{padding:"10px"},attrs:{"z-index":10,"class-name":"sub-navbar "+e.postForm.status}},[i("CommentDropdown",{model:{value:e.postForm.comment_disabled,callback:function(t){e.$set(e.postForm,"comment_disabled",t)},expression:"postForm.comment_disabled"}}),e._v(" "),i("LabelDropdown",{attrs:{labelName:e.postForm.labelName},on:{setLabel:e.setLabel}}),e._v(" "),i("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{"margin-left":"10px"},attrs:{type:"success",plain:""},on:{click:e.handlePublish}},[e._v("\n        发布\n      ")]),e._v(" "),i("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{type:"warning",plain:""},on:{click:e.handleDraft}},[e._v("\n        草稿\n      ")]),e._v(" "),i("el-select",{staticStyle:{"margin-left":"10px"},attrs:{"remote-method":e.getRemoteUserList,filterable:"","default-first-option":"",remote:"",placeholder:"搜索作者"},model:{value:e.postForm.author,callback:function(t){e.$set(e.postForm,"author",t)},expression:"postForm.author"}},e._l(e.userListOptions,function(e,t){return i("el-option",{key:e+t,attrs:{label:e,value:e}})}),1),e._v(" "),i("el-date-picker",{staticStyle:{"margin-left":"10px"},attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss",placeholder:"发布时间"},model:{value:e.displayTime,callback:function(t){e.displayTime=t},expression:"displayTime"}})],1),e._v(" "),i("div",{staticClass:"createPost-main-container"},[i("el-row",[i("el-col",{attrs:{span:24,align:"center"}},[i("el-form-item",{staticStyle:{"margin-bottom":"40px",width:"80%"},attrs:{prop:"title"}},[i("MDinput",{attrs:{maxlength:100,name:"name",required:""},model:{value:e.postForm.title,callback:function(t){e.$set(e.postForm,"title",t)},expression:"postForm.title"}},[e._v("\n              标题\n            ")])],1)],1)],1),e._v(" "),i("el-form-item",{staticStyle:{"margin-bottom":"30px"},attrs:{prop:"content"}},[i("div",{attrs:{id:e.id}})]),e._v(" "),i("el-form-item",{staticStyle:{"margin-bottom":"30px"},attrs:{prop:"image_uri"}},[i("Upload",{model:{value:e.postForm.image_uri,callback:function(t){e.$set(e.postForm,"image_uri",t)},expression:"postForm.image_uri"}})],1)],1)],1)],1)},n=[],l=i("db72"),o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"upload-container"},[i("el-upload",{staticClass:"image-uploader",attrs:{data:e.dataObj,multiple:!1,"show-file-list":!1,"on-success":e.handleImageSuccess,drag:"",action:"https://httpbin.org/post"}},[i("i",{staticClass:"el-icon-upload"}),e._v(" "),i("div",{staticClass:"el-upload__text"},[e._v("\n      将文件拖到此处，或"),i("em",[e._v("点击上传")])])]),e._v(" "),i("div",{staticClass:"image-preview image-app-preview"},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.imageUrl.length>1,expression:"imageUrl.length>1"}],staticClass:"image-preview-wrapper"},[i("img",{attrs:{src:e.imageUrl}}),e._v(" "),i("div",{staticClass:"image-preview-action"},[i("i",{staticClass:"el-icon-delete",on:{click:e.rmImage}})])])]),e._v(" "),i("div",{staticClass:"image-preview"},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.imageUrl.length>1,expression:"imageUrl.length>1"}],staticClass:"image-preview-wrapper"},[i("img",{attrs:{src:e.imageUrl}}),e._v(" "),i("div",{staticClass:"image-preview-action"},[i("i",{staticClass:"el-icon-delete",on:{click:e.rmImage}})])])])],1)},r=[],s=i("b775");function u(){return Object(s["a"])({url:"/qiniu/upload/token",method:"get"})}var d={name:"SingleImageUpload3",props:{value:{type:String,default:""}},data:function(){return{tempUrl:"",dataObj:{token:"",key:""}}},computed:{imageUrl:function(){return this.value}},methods:{rmImage:function(){this.emitInput("")},emitInput:function(e){this.$emit("input",e)},handleImageSuccess:function(e){this.emitInput(e.files.file)},beforeUpload:function(){var e=this,t=this;return new Promise(function(i,a){u().then(function(a){var n=a.data.qiniu_key,l=a.data.qiniu_token;t._data.dataObj.token=l,t._data.dataObj.key=n,e.tempUrl=a.data.qiniu_url,i(!0)}).catch(function(e){console.log(e),a(!1)})})}}},c=d,m=(i("0bd9"),i("2877")),p=Object(m["a"])(c,o,r,!1,null,"0e0b11b7",null),h=p.exports,f=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"material-input__component",class:e.computedClasses},[i("div",{class:{iconClass:e.icon}},[e.icon?i("i",{staticClass:"el-input__icon material-input__icon",class:["el-icon-"+e.icon]}):e._e(),e._v(" "),"email"===e.type?i("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,readonly:e.readonly,disabled:e.disabled,autocomplete:e.autoComplete,required:e.required,type:"email"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),e._v(" "),"url"===e.type?i("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,readonly:e.readonly,disabled:e.disabled,autocomplete:e.autoComplete,required:e.required,type:"url"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),e._v(" "),"number"===e.type?i("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,step:e.step,readonly:e.readonly,disabled:e.disabled,autocomplete:e.autoComplete,max:e.max,min:e.min,minlength:e.minlength,maxlength:e.maxlength,required:e.required,type:"number"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),e._v(" "),"password"===e.type?i("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,readonly:e.readonly,disabled:e.disabled,autocomplete:e.autoComplete,max:e.max,min:e.min,required:e.required,type:"password"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),e._v(" "),"tel"===e.type?i("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,readonly:e.readonly,disabled:e.disabled,autocomplete:e.autoComplete,required:e.required,type:"tel"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),e._v(" "),"text"===e.type?i("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,readonly:e.readonly,disabled:e.disabled,autocomplete:e.autoComplete,minlength:e.minlength,maxlength:e.maxlength,required:e.required,type:"text"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),e._v(" "),i("span",{staticClass:"material-input-bar"}),e._v(" "),i("label",{staticClass:"material-label"},[e._t("default")],2)])])},g=[],v=(i("c5f6"),{name:"MdInput",props:{icon:String,name:String,type:{type:String,default:"text"},value:[String,Number],placeholder:String,readonly:Boolean,disabled:Boolean,min:String,max:String,step:String,minlength:Number,maxlength:Number,required:{type:Boolean,default:!0},autoComplete:{type:String,default:"off"},validateEvent:{type:Boolean,default:!0}},data:function(){return{currentValue:this.value,focus:!1,fillPlaceHolder:null}},computed:{computedClasses:function(){return{"material--active":this.focus,"material--disabled":this.disabled,"material--raised":Boolean(this.focus||this.currentValue)}}},watch:{value:function(e){this.currentValue=e}},methods:{handleModelInput:function(e){var t=e.target.value;this.$emit("input",t),"ElFormItem"===this.$parent.$options.componentName&&this.validateEvent&&this.$parent.$emit("el.form.change",[t]),this.$emit("change",t)},handleMdFocus:function(e){this.focus=!0,this.$emit("focus",e),this.placeholder&&""!==this.placeholder&&(this.fillPlaceHolder=this.placeholder)},handleMdBlur:function(e){this.focus=!1,this.$emit("blur",e),this.fillPlaceHolder=null,"ElFormItem"===this.$parent.$options.componentName&&this.validateEvent&&this.$parent.$emit("el.form.blur",[this.currentValue])}}}),b=v,y=(i("49b7"),Object(m["a"])(b,f,g,!1,null,"9d7baaf6",null)),_=y.exports,w=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{style:{height:e.height+"px",zIndex:e.zIndex}},[i("div",{class:e.className,style:{top:e.isSticky?e.stickyTop+"px":"",zIndex:e.zIndex,position:e.position,width:e.width,height:e.height+"px"}},[e._t("default",[i("div",[e._v("sticky")])])],2)])},x=[],S={name:"Sticky",props:{stickyTop:{type:Number,default:0},zIndex:{type:Number,default:1},className:{type:String,default:""}},data:function(){return{active:!1,position:"",width:void 0,height:void 0,isSticky:!1}},mounted:function(){this.height=this.$el.getBoundingClientRect().height,window.addEventListener("scroll",this.handleScroll),window.addEventListener("resize",this.handleResize)},activated:function(){this.handleScroll()},destroyed:function(){window.removeEventListener("scroll",this.handleScroll),window.removeEventListener("resize",this.handleResize)},methods:{sticky:function(){this.active||(this.position="fixed",this.active=!0,this.width=this.width+"px",this.isSticky=!0)},handleReset:function(){this.active&&this.reset()},reset:function(){this.position="",this.width="auto",this.active=!1,this.isSticky=!1},handleScroll:function(){var e=this.$el.getBoundingClientRect().width;this.width=e||"auto";var t=this.$el.getBoundingClientRect().top;t<this.stickyTop?this.sticky():this.handleReset()},handleResize:function(){this.isSticky&&(this.width=this.$el.getBoundingClientRect().width+"px")}}},k=S,C=Object(m["a"])(k,w,x,!1,null,null,null),V=C.exports,F=i("2423");function $(e){return Object(s["a"])({url:"/search/user",method:"get",params:{name:e}})}var O=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dropdown",{attrs:{"show-timeout":100,trigger:"click"}},[i("el-button",{attrs:{plain:""}},[e._v("\n    "+e._s(e.comment_disabled?"评论关闭":"评论开启")+"\n    "),i("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),e._v(" "),i("el-dropdown-menu",{staticClass:"no-padding",attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",[i("el-radio-group",{staticStyle:{padding:"10px"},model:{value:e.comment_disabled,callback:function(t){e.comment_disabled=t},expression:"comment_disabled"}},[i("el-radio",{attrs:{label:!0}},[e._v("\n          评论关闭\n        ")]),e._v(" "),i("el-radio",{attrs:{label:!1}},[e._v("\n          评论开启\n        ")])],1)],1)],1)],1)},j=[],M={props:{value:{type:Boolean,default:!1}},computed:{comment_disabled:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}}},E=M,I=Object(m["a"])(E,O,j,!1,null,null,null),N=I.exports,P=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dropdown",{attrs:{"show-timeout":100,trigger:"click"}},[i("el-button",{attrs:{plain:""}},[e._v("\n    链接\n    "),i("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),e._v(" "),i("el-dropdown-menu",{staticClass:"no-padding no-border",staticStyle:{width:"400px"},attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-form-item",{staticStyle:{"margin-bottom":"0px"},attrs:{"label-width":"0px",prop:"source_uri"}},[i("el-input",{attrs:{placeholder:"Please enter the content"},model:{value:e.source_uri,callback:function(t){e.source_uri=t},expression:"source_uri"}},[i("template",{slot:"prepend"},[e._v("\n          URL\n        ")])],2)],1)],1)],1)},q=[],B={props:{value:{type:String,default:""}},computed:{source_uri:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}}},R=B,L=Object(m["a"])(R,P,q,!1,null,null,null),T=(L.exports,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-select",{attrs:{placeholder:e.labelName},model:{value:e.label,callback:function(t){e.label=t},expression:"label"}},[i("el-option",{staticStyle:{height:"auto"},attrs:{value:e.mineStatusValue}},[i("el-tree",{ref:"tree",attrs:{data:e.data,"node-key":"id","highlight-current":"",accordion:"",props:e.defaultProps},on:{"node-click":e.handleCheck}})],1)],1)}),H=[],U=i("34cd"),D={props:{labelName:{type:String,default:""}},data:function(){return{mineStatusValue:[],label:null,data:null,defaultProps:{children:"children",label:"label",id:-1}}},created:function(){this.getTree()},methods:{getTree:function(){var e=this;Object(U["b"])(!1).then(function(t){e.data=t.data.tree})},handleCheck:function(e){e.children||(this.mineStatusValue=e,this.label=e.label,this.$emit("setLabel",e.id))}}},z=D,J=Object(m["a"])(z,T,H,!1,null,null,null),A=J.exports,G=(i("a7be"),i("44f8"),i("a6e0"),i("547e")),K=i.n(G),Q={height:"800px",previewStyle:"vertical",useCommandShortcut:!0,useDefaultHTMLSanitizer:!0,usageStatistics:!1,hideModeSwitch:!1,toolbarItems:["heading","bold","italic","strike","divider","hr","quote","divider","ul","ol","task","indent","outdent","divider","table","image","link","divider","code","codeblock"]},W={status:"draft",labelId:0,labelName:"",title:"",detail:"",source_uri:"",image_uri:"",date:void 0,id:void 0,comment_disabled:!1},X={name:"ArticleDetail",components:{MDinput:_,Upload:h,Sticky:V,CommentDropdown:N,LabelDropdown:A},props:{isEdit:{type:Boolean,default:!1},value:{type:String,default:""},id:{type:String,required:!1,default:function(){return"markdown-editor-"+ +new Date+(1e3*Math.random()).toFixed(0)}},options:{type:Object,default:function(){return Q}},mode:{type:String,default:"markdown"},height:{type:String,required:!1,default:"600px"},language:{type:String,required:!1,default:"zh_CN"}},data:function(){var e=this,t=function(t,i,a){""===i?(e.$message({message:t.field+"为必传项",type:"error"}),a(new Error(t.field+"为必传项"))):a()};return{postForm:Object.assign({},W),loading:!1,userListOptions:[],rules:{title:[{validator:t}],detail:[{validator:t}]},tempRoute:{},editor:null}},computed:{displayTime:{get:function(){return+new Date(this.postForm.date)},set:function(e){this.postForm.date=new Date(e)}},editorOptions:function(){var e=Object.assign({},Q,this.options);return e.initialEditType=this.mode,e.height=this.height,e.language=this.language,e}},watch:{value:function(e,t){e!==t&&e!==this.editor.getValue()&&this.editor.setValue(e)},language:function(e){this.destroyEditor(),this.initEditor()},height:function(e){this.editor.height(e)},mode:function(e){this.editor.changeMode(e)}},created:function(){if(this.isEdit){var e=this.$route.params&&this.$route.params.id;this.fetchData(e)}else this.postForm=Object.assign({},W);this.tempRoute=Object.assign({},this.$route)},mounted:function(){this.initEditor()},destroyed:function(){this.destroyEditor()},methods:{fetchData:function(e){var t=this;Object(F["c"])(e).then(function(e){t.postForm=e.data,t.setTagsViewTitle(),t.setPageTitle(),t.setValue(t.postForm.detail)}).catch(function(e){console.log(e)})},setTagsViewTitle:function(){var e="编辑文章",t=Object.assign({},this.tempRoute,{title:"".concat(e,"-").concat(this.postForm.id)});this.$store.dispatch("tagsView/updateVisitedView",t)},setPageTitle:function(){var e="编辑文章";document.title="".concat(e," - ").concat(this.postForm.id)},setLabel:function(e){this.postForm.labelId=e},submitForm:function(){var e=this;this.$refs.postForm.validate(function(t){if(!t)return console.log("error submit!!"),!1;e.isEdit?Object(F["f"])(e.postForm).then(function(t){e.handleResponse(t)}):Object(F["a"])(e.postForm).then(function(t){e.handleResponse(t)})})},handleDraft:function(){this.postForm.detail=this.editor.getValue(),this.postForm.status="draft",this.submitForm()},handlePublish:function(){this.postForm.detail=this.editor.getValue(),this.postForm.status="published",this.submitForm()},handleResponse:function(e){2e4!==e.code?this.$notify({title:"失败",message:e.message,type:"success",duration:2e3}):this.$notify({title:"成功",message:"操作成功",type:"success",duration:2e3}),this.loading=!1},getRemoteUserList:function(e){var t=this;$(e).then(function(e){e.data.items&&(t.userListOptions=e.data.items)})},initEditor:function(){var e=this;this.editor=new K.a(Object(l["a"])({el:document.getElementById(this.id)},this.editorOptions)),this.value&&this.editor.setValue(this.value),this.editor.on("change",function(){e.$emit("input",e.editor.getValue())})},destroyEditor:function(){this.editor&&(this.editor.off("change"),this.editor.remove())},setValue:function(e){this.editor.setValue(e)},getValue:function(){return this.editor.getValue()},setHtml:function(e){this.editor.setHtml(e)},getHtml:function(){return this.editor.getHtml()}}},Y=X,Z=(i("e3dd"),Object(m["a"])(Y,a,n,!1,null,"42772250",null));t["a"]=Z.exports},cf8f:function(e,t,i){},dc44:function(e,t,i){},e3dd:function(e,t,i){"use strict";var a=i("cf8f"),n=i.n(a);n.a}}]);